@model CondoManagementWebApp.Models.SysAdminDashboardViewModel

@{
    ViewData["Title"] = "SysAdminDashboard";
}

<div class="row page-titles mx-0 d-flex align-items-center">
    <div class="col-sm-6 p-md-0">
        <div class="welcome-text">
            <h4>Manage users</h4>
        </div>
    </div>
    <div class="col-sm-6 p-md-0 text-sm-end mt-2 mt-sm-0">
        <a asp-action="Register" asp-controller="Account" class="btn text-white" style="background-color: #32CD32;">
            Register User
        </a>
    </div>
</div>


@* Accordion for Condo Members *@
<div class="accordion" id="accordionCondoMembers">
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingCondoMembers">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCondoMembers" aria-expanded="false" aria-controls="collapseCondoMembers">
                Condo Members
            </button>
        </h2>
        <div id="collapseCondoMembers" class="accordion-collapse collapse" aria-labelledby="headingCondoMembers" data-bs-parent="#accordionCondoMembers">
            <div class="accordion-body">
                @if (Model.CondoMembers != null && Model.CondoMembers.Any())
                {
                    <table class="table">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var member in Model.CondoMembers)
                            {
                                <tr>
                                    <td>
                                        <img src="@(member.ImageFullPath)" alt="User Image" class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;" />
                                    </td>
                                    <td>@member.FullName</td>
                                    <td>@member.Email</td>
                                    <td>
                                        @if (member.IsActive)
                                        {
                                            <span class="badge bg-success" style="font-size: 1.1em;">Active</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-danger" style="font-size: 1.1em;">Inactive</span>
                                        }
                                    </td>
                                    <td>
                                        <a class="btn btn-outline-primary" asp-controller="Account" asp-action="EditUserDetails" asp-route-email="@member.Email">Edit Details</a>
                                        <a class="btn btn-outline-secondary" asp-controller="Account" asp-action="AssignCompany" asp-route-email="@member.Email">Manage Companies</a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <p colspan="5" class="text-center text-muted">No condo members found.</p>
                }
            </div>
        </div>
    </div>
</div>

@* Accordion for Company Admins *@
<div class="accordion mt-4" id="accordionCompanyAdmins">
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingCompanyAdmins">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCompanyAdmins" aria-expanded="false" aria-controls="collapseCompanyAdmins">
                Company Admins
            </button>
        </h2>
        <div id="collapseCompanyAdmins" class="accordion-collapse collapse" aria-labelledby="headingCompanyAdmins" data-bs-parent="#accordionCompanyAdmins">
            <div class="accordion-body">
                @if (Model.CompanyAdmins != null && Model.CompanyAdmins.Any())
                {
                    <table class="table">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Company</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var admin in Model.CompanyAdmins)
                            {
                                <tr>
                                    <td>
                                        <img src="@(admin.ImageFullPath)" alt="User Image" class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;" />
                                    </td>
                                    <td>@admin.FullName</td>
                                    <td>@admin.Email</td>
                                    <td>
                                        @if (admin.IsActive)
                                        {
                                            <span class="badge bg-success" style="font-size: 1.1em;">Active</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-danger" style="font-size: 1.1em;">Inactive</span>
                                        }
                                    </td>
                                    @if (!admin.CompaniesDto.Any())
                                    {
                                        <td style="color: red; font-weight: bold;">No Company Assigned</td>
                                    }
                                    else
                                    {
                                        <td>@admin.CompaniesDto.First().Name</td>
                                    }
                                    <td>
                                        <a class="btn btn-outline-primary" asp-controller="Account" asp-action="EditUserDetails" asp-route-email="@admin.Email">Edit Details</a>
                                        <a class="btn btn-outline-secondary" asp-controller="Account" asp-action="AssignCompany" asp-route-email="@admin.Email">Change Company</a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <p class="text-center text-muted">No company admins found.</p>
                }
            </div>
        </div>
    </div>
</div>

@* Accordion for Condo Managers *@
<div class="accordion mt-4" id="accordionCondoManagers">
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingCondoManagers">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCondoManagers" aria-expanded="false" aria-controls="collapseCondoManagers">
                Condo Managers
            </button>
        </h2>
        <div id="collapseCondoManagers" class="accordion-collapse collapse" aria-labelledby="headingCondoManagers" data-bs-parent="#accordionCondoManagers">
            <div class="accordion-body">
                @if (Model.CondoManagers != null && Model.CondoManagers.Any())
                {
                    <table class="table">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Status</th>
                                <th>Company</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var manager in Model.CondoManagers)
                            {
                                <tr>
                                    <td>
                                        <img src="@(manager.ImageFullPath)" alt="User Image" class="rounded-circle" style="width: 40px; height: 40px; object-fit: cover;" />
                                    </td>
                                    <td>@manager.FullName</td>
                                    <td>@manager.Email</td>
                                    <td>
                                        @if (manager.IsActive)
                                        {
                                            <span class="badge bg-success" style="font-size: 1.1em;">Active</span>
                                        }
                                        else
                                        {
                                            <span class="badge bg-danger" style="font-size: 1.1em;">Inactive</span>
                                        }
                                    </td>
                                    @if (!manager.CompaniesDto.Any())
                                    {
                                        <td style="color: red; font-weight: bold;">No Company Assigned</td>
                                    }
                                    else
                                    {
                                        <td>@manager.CompaniesDto.First().Name</td>
                                    }
                                    <td>
                                        <a class="btn btn-outline-primary" asp-controller="Account" asp-action="EditUserDetails" asp-route-email="@manager.Email">Edit Details</a>
                                        <a class="btn btn-outline-secondary" asp-controller="Account" asp-action="AssignCompany" asp-route-email="@manager.Email">Change Company</a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <p class="text-center text-muted">No condo managers found.</p>
                }
            </div>
        </div>
    </div>
</div>


@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}