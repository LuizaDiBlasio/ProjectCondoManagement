@model CondoManagementWebApp.Models.ForgotPasswordViewModel

<div class="modal-header">
    <h5 class="modal-title" id="forgotPasswordModalLabel">Reset your password</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">
    <p>Please enter your email address to receive a password reset link.</p>
    <form id="forgotPasswordForm">
        <div id="forgotPasswordErrorSummary" class="text-danger mb-4" style="display: none;"></div>

        <div class="form-group mb-4">
            <label class="form-label" for="forgotPasswordEmail">Email Address</label>
            <input type="email" asp-for="Email" class="form-control" placeholder="Enter your email" id="forgotPasswordEmail">
        </div>
    </form>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
    <button type="button" class="btn btn-primary" id="sendResetLinkButton">Send Reset Link</button>
</div>



            <script>
                // Usa $(document).on para garantir que o evento seja vinculado mesmo após o conteúdo ser carregado por AJAX
                $(document).on('click', '#sendResetLinkButton', function() {
                    var email = $('#forgotPasswordEmail').val();
                    var errorContainer = $('#forgotPasswordErrorSummary');

                    // Validação básica no front-end
                    if (!email) {
                        errorContainer.text('Please enter a valid email address.').show();
                        return;
                    }

                    // Desabilita o botão e mostra feedback visual
                    $(this).prop('disabled', true).text('Sending...');

                    $.ajax({
                        url: '@Url.Action("ForgotPassword", "Account")',
                        type: 'POST',
                        data: { Email: email },
                        success: function(data) {
                            if (data.isSuccess) {
                                // Atualiza o conteúdo da modal com a mensagem de sucesso
                                var successHtml = '<div class="modal-header"><h5 class="modal-title">Success</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><p>' + data.message + '</p></div><div class="modal-footer"><button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button></div>';
                                $('#forgotPasswordModalContent').html(successHtml);
                            } else {
                                // Reabilita o botão e exibe a mensagem de erro
                                $('#sendResetLinkButton').prop('disabled', false).text('Send Reset Link');
                                errorContainer.text(data.message || 'An error occurred. Please try again 1.').show();
                            }
                        },
                        error: function(xhr) {
                            // Reabilita o botão e exibe a mensagem de erro da requisição
                            $('#sendResetLinkButton').prop('disabled', false).text('Send Reset Link');
                            var errorMsg = xhr.responseJSON && xhr.responseJSON.message ? xhr.responseJSON.message : 'An error occurred. Please try again 2.';
                            errorContainer.text(errorMsg).show();
                        }
                    });
                });

                // Limpa a mensagem de erro quando o usuário digita
                $(document).on('input', '#forgotPasswordEmail', function() {
                    $('#forgotPasswordErrorSummary').hide();
                });
            </script>
        