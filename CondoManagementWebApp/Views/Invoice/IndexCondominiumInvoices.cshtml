@model IEnumerable<ClassLibrary.DtoModels.CondominiumWithInvoicesDto>

@{
	ViewData["Title"] = "Condominium Invoices";
}

<div class="row page-titles mx-0 d-flex align-items-center">
	<div class="col-sm-6 p-md-0">
		<div class="welcome-text">
			<h4>Condominium Invoices</h4>
		</div>
	</div>
	<div class="col-sm-6 p-md-0 text-sm-end mt-2 mt-sm-0">
		<a asp-controller="Invoice" asp-action="IndexAllCondoMembersInvoices" class="btn btn-primary me-2">Member's invoices</a>
	</div>
</div>

@if (!Model.Any())
{
	<p class="mt-4">No condominiums found with invoices.</p>
}
else
{
	<div class="accordion" id="invoicesAccordion">
		@foreach (var condo in Model)
		{
			<div class="accordion-item mt-4">
				<h2 class="accordion-header" id="heading_@condo.CondominiumId">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
							data-bs-target="#collapse_@condo.CondominiumId" aria-expanded="false"
							aria-controls="collapse_@condo.CondominiumId">
						@condo.CondoName
					</button>
				</h2>
				<div id="collapse_@condo.CondominiumId" class="accordion-collapse collapse"
					 aria-labelledby="heading_@condo.CondominiumId" data-bs-parent="#invoicesAccordion">
					<div class="accordion-body p-0">
						@if (condo.InvoicesDto != null && condo.InvoicesDto.Any())
						{
							<div class="table-responsive">
								<table class="table table-striped table-hover">
									<thead>
										<tr>
											<th>Invoice #</th>
											<th>Payment Date</th>
											<th></th>
										</tr>
									</thead>
									<tbody>
										@foreach (var invoice in condo.InvoicesDto)
										{
											<tr>
												<td>@Html.DisplayFor(modelItem => invoice.Id)</td>
												<td>@invoice.PaymentDate.ToShortDateString()</td>
												<td>
													@Html.ActionLink("Details", "InvoiceDetails", new { id = invoice.Id }, new { @class = "btn btn-outline-info" })
												</td>
											</tr>
										}
									</tbody>
								</table>
							</div>
						}
						else
						{
							<p class="mt-3 text-center text-muted">No invoices found for this condominium.</p>
						}
					</div>
				</div>
			</div>
		}
	</div>
}